
import React, { useState } from "react";
import { Stack, Button, IconButton } from "@mui/material";
import { useNavigate } from "react-router-dom"; // Import useNavigate
import p1 from "../../../images/p3.jpeg";
import FacebookIcon from "@mui/icons-material/Facebook";
// import TwitterIcon from "@mui/icons-material/Twitter";
import InstagramIcon from "@mui/icons-material/Instagram";
import WhatsAppIcon from "@mui/icons-material/WhatsApp";
import AccountCircleIcon from "@mui/icons-material/AccountCircle";
import Cookies from 'js-cookie';
import './Family.css';
import { useDispatch } from "react-redux";
import { setSelectedRelations } from "../../../../storage/relationsSlice";

function Family() {
   
  const dispatch = useDispatch();

  // const [usergender, setUserGender] = useState("");
  // taking Gender Dynamically
  
  const usergender = Cookies.get('UserDetails');

  // Taking Insurance Type Dynamic
// const [insurenceType, setInsurenceType] = useState("Individual");
const insurenceType = Cookies.get('insuranceType');

console.log(insurenceType);
  const [MultipleRelation, setMultipleRelation] = useState([]);
  const [relationName, setRelationname] = useState("");
  
  const [selectedButton, setSelectedButton] = useState(null);
  const [showMoreMembers, setShowMoreMembers] = useState(false);

  // Store Son and Daughter details in arrays
  const [sonDetails, setSonDetails] = useState([]);
  const [daughterDetails, setDaughterDetails] = useState([]);

  const navigate = useNavigate(); // Initialize navigate


  const handleButtonClick = (button, relation) => {
    setSelectedButton(button);
    setRelationname(relation);
  };

  const handleToggleRelation = (relation) => {
    if (insurenceType === "Individual") {
      // For Individual type, allow selecting Daughter and Son as well
      setMultipleRelation([relation]);
    } else {
      // For other types, allow multiple relations
      setMultipleRelation((prev) =>
        prev.includes(relation)
          ? prev.filter((item) => item !== relation)
          : [...prev, relation]
      );
    }
  };

  const toggleShowMoreMembers = () => {
    setShowMoreMembers(true); // Always show more members
  };

  // const isContinueButtonEnabled = MultipleRelation.length > 0;

  const handleContinue = () => {
    if (isContinueButtonEnabled) {
      const combinedData = [
        ...MultipleRelation,
        ...sonDetails,
        ...daughterDetails,
      ];
      dispatch(setSelectedRelations(combinedData));
      navigate("/page"); // Navigate to the desired route
    }
  };

  const isContinueButtonEnabled = insurenceType === "Individual"
  ? (
    MultipleRelation.length > 0 || daughterDetails.length > 0 || sonDetails.length > 0  // Ensure that at least one relation or daughter/son detail is selected
    
    )
  : (
    (MultipleRelation.length + daughterDetails.length + sonDetails.length) >= 2
    );

  // MultipleRelation.length > 0 || (daughterDetails.length > 0 || sonDetails.length > 0);

  //   const isContinueButtonEnabled =
  // (insurenceType == "Family" && MultipleRelation.length >= 2);
  // (insurenceType == "Individual" && MultipleRelation.length === 1);


  // const isContinueButtonEnabled =
  // (insurenceType === "Family" &&
  //   MultipleRelation.length === 2 &&
  //   MultipleRelation.every(relation => relation === "daughter" || relation === "son")) ||
  // (insurenceType === "Individual" && MultipleRelation.length === 1);


  const imageSelfIcon =
    usergender === "male"
    // usergender === "Male"
      ? "https://cdn-icons-png.flaticon.com/512/3070/3070663.png"
      : "https://thumb.ac-illust.com/be/bee98c70d1cfc02d0f387d2852464bf5_t.jpeg";

  const imageHusbandIcon =
    usergender === "male"
    // usergender === "Male"
      ? "https://thumb.ac-illust.com/be/bee98c70d1cfc02d0f387d2852464bf5_t.jpeg"
      : "https://cdn-icons-png.flaticon.com/512/3070/3070663.png";

  const relationValue = usergender === "male" ? "Wife" : "Husband";

  // Handle increment and decrement for Daughter and Son with a limit of 4
  const handleIncrement = (relation) => {
    if (relation === "Daughter" && daughterDetails.length < 4) {
      setDaughterDetails((prevDetails) => [...prevDetails, "Daughter"]);
    }
    if (relation === "Son" && sonDetails.length < 4) {
      setSonDetails((prevDetails) => [...prevDetails, "Son"]);
    }
  };

  const handleDecrement = (relation) => {
    if (relation === "Daughter" && daughterDetails.length > 0) {
      setDaughterDetails((prevDetails) => prevDetails.slice(0, -1));
    }
    if (relation === "Son" && sonDetails.length > 0) {
      setSonDetails((prevDetails) => prevDetails.slice(0, -1));
    }
  };

  console.log("Daughter Details:", daughterDetails);
  console.log("Son Details:", sonDetails);

  console.log(MultipleRelation);

  Cookies.set('RelatioData',MultipleRelation);

  return (
    <div>
      <div style={{ height: "100%" }}>
        <nav className="navbar navbar-light bg-light">
          <div className="ms-4">
            <img
              src={p1}
              alt="Logo"
              width="180px"
              height="45px"
            />
          </div>

          <div className="d-flex align-items-center me-4">
            <AccountCircleIcon fontSize="large" className="text-dark" />
          </div>
        </nav>
      </div>
      <div>
        <div className="text-center mt-3">
          <h1 style={{ fontSize: "30px" }}>Covered Relations</h1>
        </div>
        {/* <div className="text-center fs-5">
          <h5>Gender: {usergender }</h5>
        </div> */}

       {/* <div className="text-center fs-5">
       <h5>Gender: {usergender ? usergender.charAt(0).toUpperCase() + usergender.slice(1) : ""}</h5>
       </div> */}

         <div className=" type text-center fs-5">
          {/* <p>Insurance Type: {insurenceType}</p> */}
          <p><strong>Insurance Type:</strong> {insurenceType}</p>
         </div> 

        <div style={{ marginTop: "50px", textAlign: "center" }}>
          <Stack spacing={2} direction="row" justifyContent="center">
            <Button
              variant={MultipleRelation.includes("Self") ? "contained" : "outlined"}
              style={{
                width: "150px",
                height: "80px",
                border: "2px solid black",
              }}
              onClick={() => handleToggleRelation("Self")}
              startIcon={
                <img
                  src={imageSelfIcon}
                  alt="Self"
                  style={{ width: "28px", height: "28px" }}
                />
              }
            >
              Self
            </Button>
            <Button
              variant={MultipleRelation.includes(relationValue) ? "contained" : "outlined"}
              style={{
                width: "150px",
                height: "80px",
                border: "2px solid black",
              }}
              onClick={() => handleToggleRelation(relationValue)}
              startIcon={
                <img
                  src={imageHusbandIcon}
                  alt="Husband"
                  style={{ width: "28px", height: "28px" }}
                />
              }
            >
              {relationValue}
            </Button>
            <Button
              variant={MultipleRelation.includes("Mother") ? "contained" : "outlined"}
              style={{
                width: "150px",
                height: "80px",
                border: "2px solid black",
              }}
              onClick={() => handleToggleRelation("Mother")}
              startIcon={
                <img
                  src="https://png.pngtree.com/png-vector/20220210/ourlarge/pngtree-avatar-female-character-mother-png-image_4384454.png"
                  alt="Mother"
                  style={{ width: "28px", height: "28px" }}
                />
              }
            >
              Mother
            </Button>
            <Button
              variant={MultipleRelation.includes("Father") ? "contained" : "outlined"}
              style={{
                width: "150px",
                height: "80px",
                border: "2px solid black",
              }}
              onClick={() => handleToggleRelation("Father")}
              startIcon={
                <img
                  src="https://www.icon0.com/free/static2/preview2/stock-photo-indian-man-avatar-people-icon-character-cartoon-32890.jpg"
                  alt="Father"
                  style={{ width: "28px", height: "28px" }}
                />
              }
            >
              Father
            </Button>
          </Stack>
          <div style={{ marginTop: "35px", padding: "32px" }}>
            <Stack spacing={2} direction="row" justifyContent="center">
              {/* Daughter Button with Increment/Decrement */}
              <div>
                {insurenceType === "Family" ? ( 
                  <div>
                    <div
                      style={{
                        width: "150px",
                        height: "100px",
                         border: "2px solid black",
                        textAlign: "center",
                        borderRadius: "8px",
                        padding: "10px",
                        color:"black",
                        // backgroundColor: daughterDetails.length > 0 ? "contained" : "blue",
                        // border: daughterDetails.length > 0 ? "2px solid black" : "2px solid black",

                      }}
                    >
                      <img
                        src="https://img.freepik.com/premium-vector/daughter-icon-vector-image-can-be-used-family-life_120816-219665.jpg?w=360"
                        alt="Daughter"
                        style={{ width: "28px", height: "28px" }}
                      />
                      <p className="text-primary">DAUGHTER</p>
                      <div
                        style={{
                          display: "flex",
                          justifyContent: "center",
                          alignItems: "center",
                        }}
                      >
                        <button
                          onClick={() => handleDecrement("Daughter")}
                          disabled={daughterDetails.length <= 0}
                          style={{
                            padding: "0 10px",
                            fontSize: "16px",
                            cursor: daughterDetails.length > 0 ? "pointer" : "not-allowed",
                          }}
                        >
                          -
                        </button>
                        <span style={{ margin: "0 10px" }}>{daughterDetails.length}</span>
                        <button
                          onClick={() => handleIncrement("Daughter")}
                          disabled={daughterDetails.length >= 4}
                          style={{
                            padding: "0 10px",
                            fontSize: "16px",
                            cursor: daughterDetails.length < 4 ? "pointer" : "not-allowed",
                          }}
                        >
                          +
                        </button>
                      </div>
                    </div>
                  </div>
                ) : (
                  <div>
                    <Button
                      variant={daughterDetails.length>0 ? "contained" : "outlined"}
                      style={{
                        width: "150px",
                        height: "80px",
                        border: "2px solid black",
                      }}
                      onClick={() => handleToggleRelation("Daughter")}
                      startIcon={
                        <img
                          src="https://img.freepik.com/premium-vector/daughter-icon-vector-image-can-be-used-family-life_120816-219665.jpg?w=360"
                          alt="Daughter"
                          style={{ width: "28px", height: "28px" }}
                        />
                      }
                    >
                      Daughter
                    </Button>
                  </div>
                )}
              </div>

              {/* Son Button with Increment/Decrement */}
              <div>
                {insurenceType === "Family" ? (
                  <div>
                    <div
                      style={{
                        width: "150px",
                        height: "100px",
                        border: "2px solid black",
                        // border: sonDetails.length > 0 ? "3px solid blue" : "2px solid black",
                        textAlign: "center",
                        borderRadius: "8px",
                        padding: "10px",
                        // backgroundColor: sonDetails.length > 0 ? "#f0f8ff" : "white",

                      }}
                    >
                      <img
                        src="https://cdn-icons-png.freepik.com/512/7084/7084418.png"
                        alt="Son"
                        style={{ width: "28px", height: "28px" }}
                      />
                      <p className="text-primary">SON</p>
                      <div
                        style={{
                          display: "flex",
                          justifyContent: "center",
                          alignItems: "center",
                        }}
                      >
                        <button
                          onClick={() => handleDecrement("Son")}
                          disabled={sonDetails.length <= 0}
                          style={{
                            padding: "0 10px",
                            fontSize: "16px",
                            cursor: sonDetails.length > 0 ? "pointer" : "not-allowed",
                          }}
                        >
                          -
                        </button>
                        <span style={{ margin: "0 10px" }}>{sonDetails.length}</span>
                        <button
                          onClick={() => handleIncrement("Son")}
                          disabled={sonDetails.length >= 4}
                          style={{
                            padding: "0 10px",
                            fontSize: "16px",
                            cursor: sonDetails.length < 4 ? "pointer" : "not-allowed",
                          }}
                        >
                          +
                        </button>
                      </div>
                    </div>
                  </div>
                ) : (
                  <div>
                    <Button
                      variant={sonDetails.length > 0 ? "contained" : "outlined"}
                      style={{
                        width: "155px",
                        height: "80px",
                        border: "2px solid black",
                      }}
                      onClick={() => handleToggleRelation("Son")}
                      startIcon={
                        <img
                          src="https://cdn-icons-png.freepik.com/512/7084/7084418.png"
                          alt="Son"
                          style={{ width: "28px", height: "28px" }}
                        />
                      }
                    >
                      Son
                    </Button>
                  </div>
                )}
              </div>
            </Stack>
          </div>

          {showMoreMembers && (
            <div style={{ marginTop: "35px", padding: "32px" }}>
              <Stack spacing={2} direction="row" justifyContent="center">
                <Button
                  variant={MultipleRelation.includes("Grandmother") ? "contained" : "outlined"}
                  style={{
                    width: "170px",
                    height: "80px",
                    border: "2px solid black",
                  }}
                  onClick={() => handleToggleRelation("Grandmother")}
                  startIcon={
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/4395/4395811.png"
                      alt="Grandmother"
                      style={{ width: "28px", height: "28px" }}
                    />
                  }
                >
                  Grandmother
                </Button>
                <Button
                  variant={MultipleRelation.includes("Grandfather") ? "contained" : "outlined"}
                  style={{
                    width: "165px",
                    height: "80px",
                    border: "2px solid black",
                  }}
                  onClick={() => handleToggleRelation("Grandfather")}
                  startIcon={
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/2829/2829817.png"
                      alt="Grandfather"
                      style={{ width: "28px", height: "28px" }}
                    />
                  }
                >
                  Grandfather
                </Button> 

                
                <Button
                  variant={MultipleRelation.includes("Father-in-Law") ? "contained" : "outlined"}
                  style={{
                    width: "180px",
                    height: "80px",
                    border: "2px solid black",
                  }}
                  onClick={() => handleToggleRelation("Father-in-Law")}
                  startIcon={
                    <img
                      src="https://cdn-icons-png.flaticon.com/256/1663/1663005.png"
                      alt="Father-in-Law"
                      style={{ width: "28px", height: "28px" }}
                    />
                  }
                >
                  Father-in-Law
                </Button>
                <Button
                  variant={MultipleRelation.includes("Mother-in-Law") ? "contained" : "outlined"}
                  style={{
                    width: "180px",
                    height: "80px",
                    border: "2px solid black",
                
                  }}
                  onClick={() => handleToggleRelation("Mother-in-Law")}
                  startIcon={
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/6872/6872417.png"
                      alt="Mother-in-Law"
                      style={{ width: "28px", height: "28px" }}
                    />
                  }
                >
                  Mother-in-Law
                </Button>
              </Stack>
            </div>
          )}
          <div style={{ textAlign: "center", marginTop: "20px" }}>
            {!showMoreMembers && (
              <a href="#" onClick={toggleShowMoreMembers}>
                Show More Members
              </a>
            )}
          </div>

          <div style={{ marginTop: "20px", textAlign: "center" }}>
            <Button
              variant="contained"
              color="warning"
              disabled={!isContinueButtonEnabled}
              style={{ width: "200px", height: "50px" }}
              onClick={handleContinue} // Added onClick to trigger navigation

            >
              Next
            </Button>
          </div>
        </div>
      </div>
      
      <footer
        className="bg-light text-center py-1  mt-5"
        style={{
          // bottom: 700,
          width: "100%",
        }}
      >
        <div className="d-flex justify-content-center mb-2">
          <IconButton href="https://facebook.com" target="_blank" color="primary">
            <FacebookIcon />
          </IconButton>
          {/* <IconButton href="https://twitter.com" target="_blank" color="primary">
            <TwitterIcon />
          </IconButton> */}
            <IconButton href="https://twitter.com" target="_blank" color="primary">
         <img
         src="https://allpngfree.com/apf-prod-storage-api/storage/thumbnails/twitter-new-logo-png-transparent-images-thumbnail-1697953256.jpg" // Replace with the official "X" logo URL
        alt="X"
        style={{ width: '24px', height: '24px' }}
      />
      </IconButton>
          <IconButton href="https://instagram.com" target="_blank" color="secondary">
            <InstagramIcon />
          </IconButton>
          <IconButton href="https://wa.me" target="_blank" color="success">
            <WhatsAppIcon />
          </IconButton>
        </div>
        <p>
          © All Rights Reserved 2024.{" "}
          <span className="text-danger fw-bold">RamanaSoft</span>
        </p>
      </footer>
    </div>
  );
}
export default Family;







/* General Styling */
.quotation-page {
  font-family: 'Roboto', sans-serif;
  background-color: #eef2f7;
  color: #2c3e50;
  padding: 80px;
  height: 100%;
}

.body {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin: 0 auto;
  max-width: 1200px;
  background: #ffffff;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  padding: 40px;
  height: 100%;
}

.left-section,
.right-section {
  flex: 1;
  min-width: 300px;
  padding: 20px;
  background: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #dde2e6;
}


.left-section h2,
.right-section h3 {
  color: #34495e;
  font-weight: 600;
  margin-bottom: 15px;
  font-size: 1.2rem; /* Reduced font size */
}

h3{
    font-size: large;
    font-weight: bold;
    margin-top: 10px;
}

.left section h3{
  display: flex;
}

.left-section p,
.right-section p {
  font-size: 1rem;
  color: #555;
  margin-bottom: 10px;
}

/* Range Input */
.amount-display {
  font-size: 1.2rem;
  font-weight: bold;
  text-align: center;
  margin-top: 10px;
  color: white; /* Change text color to white */
}

input[type="range"] {
  width: 100%;
  margin: 15px 0;
  appearance: none;
  background: #dde2e6;
  height: 8px;
  border-radius: 5px;
  outline: none;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-thumb {
  appearance: none;
  width: 20px;
  height: 20px;
  background: #2c3e50;
  border-radius: 50%;
  cursor: pointer;
}

input[type="range"]::-moz-range-thumb {
  width: 20px;
  height: 20px;
  background: #2c3e50;
  border-radius: 50%;
  cursor: pointer;
}

/* Premium Cards */
.premium-card {
  background: #ecf0f1;
  border-radius: 8px;
  padding: 15px;
  text-align: center;
  margin-top: 20px;
}

.premium-card h4 {
  font-size: 1rem;
  color: #2c3e50;
}

.premium-card p {
  font-size: 1.3rem;
  font-weight: 600;
  color: #34495e;
}

/* Discount Cards */
.discount-cards {
  display: flex;
  justify-content: space-between;
  gap: 15px;
  margin: 20px 0;
}

.duration-button {
  flex: 1;
  background: #ffffff;
  border: 2px solid #2c3e50;
  color: #2c3e50;
  text-align: center;
  border-radius: 8px;
  padding: 15px;
  cursor: pointer;
  font-size: 1rem;
  transition: all 0.3s;
}

.duration-button:hover {
  /* background: #2c3e50;             */
  /* background: rgb(20, 20, 222);             */
  background: rgb(137, 206, 137);
  color: #ffffff;
}

.duration-button.selected {
  /* background: #34495e; */
  background: rgb(143, 143, 227);
  color: white;
  border-color: #34495e;
}

/* Proceed Button */
.proceed-button {
  display: block;
  width: 100%;
  padding: 15px;
  background: #27ae60;
  color: #ffffff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1.1rem;
  font-weight: bold;
  text-align: center;
  margin-top: 20px;
  transition: background 0.3s;
}

.proceed-button:hover {
  background: #219150;
}

/* Media Queries */
@media (max-width: 768px) {
  .body {
      flex-direction: column;
      padding: 20px;
  }

  .discount-cards {
      flex-wrap: wrap;
  }

  .duration-button {
      flex: 1 1 100%;
  }

  .proceed-button {
      font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .left-section h2,
  .right-section h3 {
      font-size: 1rem; /* Reduced font size further */
  }

  .premium-card p {
      font-size: 1.2rem;
  }

  .proceed-button {
      padding: 12px;
  }
}

.field-spacing {
  margin-bottom: 25px;
 } 




